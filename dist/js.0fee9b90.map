{"version":3,"sources":["0","js/PublicWFS.js","js/index.js"],"names":["module","exports","PUBLIC_WFS_URL","ER_WFS_URL","EPSG_CODE","AUFBAUDATEN","parent","abschnittOderAst","vst","bst","teilnr","teilbreite","decksch","baujahr","dicke","baumonat","korngr","unscharf","kennz","art1","art2","art3","artneu","material1","material2","material3","bindemit1","bindemit2","detaila","detailb","detailc","detaild","umweltr","kherk","baujahrGew","abnahmeGew","dauerGew","ablaufGew","objektId","objektnr","erfart","quelle","ADatum","bemerkung","bearbeiter","behoerde","QUERSCHNITT","abschnittId","streifen","streifennr","art","artober","breite","bisBreite","blpart","blpart3","uipart","uipart3","XVstL","XVstR","XBstL","XBstR","CONFIG","require","PublicWFS","xml","callbackSuccess","callbackFailed","args","xmlhttp","XMLHttpRequest","open","onreadystatechange","readyState","status","responseXML","setRequestHeader","send","transaction","xml_db_request","_checkTransacktionSuccess","_checkTransacktionFailed","getElementsByTagName","length","klasse","filter","doSoapRequest","text","error","m","document","createElement","className","innerHTML","body","append","ausblenden","style","display","remove","backgroundColor","window","setTimeout","loadER","console","log","doQuery","readER","showMessage","addEventListener","er","select","getElementById","proj","i","projekt","getAttribute","firstChild","data","pid","o","v","createAttribute","value","setAttributeNode","t","createTextNode","substr","appendChild","disabled","aenderung","p"],"mappings":"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","file":"js.0fee9b90.map","sourceRoot":"..","sourcesContent":[null,"var CONFIG = require('./config.json');\n\nclass PublicWFS {\n\t\n    static doSoapRequest(xml, callbackSuccess, callbackFailed, ...args) {\n        var xmlhttp = new XMLHttpRequest();\n        xmlhttp.open('POST', CONFIG.PUBLIC_WFS_URL, true);\n    \n        \n        xmlhttp.onreadystatechange = function () {\n            if (xmlhttp.readyState != 4) return;\n            if (xmlhttp.status == 200) {\n                callbackSuccess(xmlhttp.responseXML, ...args)\n            } else {\n                callbackFailed(xmlhttp.responseXML, ...args)\n            }\n        }\n        xmlhttp.setRequestHeader('Content-Type', 'text/xml');\n        xmlhttp.send(xml);\n    }\n    \n    static doTransaction(transaction, callbackSuccess, callbackFailed, ...args) {\n        var xml = \n            '<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>' +\n            '<wfs:Transaction service=\"WFS\" version=\"1.0.0\"' +\n            '\t\txmlns=\"http://xml.novasib.de\"' +\n            '\t\txmlns:wfs=\"http://www.opengis.net/wfs\" ' +\n            '\t\txmlns:gml=\"http://www.opengis.net/gml\" ' +\n            '\t\txmlns:ogc=\"http://www.opengis.net/ogc\" ' +\n            '\t\txmlns:xlink=\"http://www.w3.org/1999/xlink\" ' +\n            '\t\txmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" ' +\n            '\t\txsi:schemaLocation=\"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd\">' +\n            transaction +\n            '</wfs:Transaction>';\n        return xml_db_request(xml, _checkTransacktionSuccess, _checkTransacktionFailed, \n            callbackSuccess, callbackFailed, ...args)\n    }\n\n    static _checkTransacktionSuccess (xml, callbackSuccess, callbackFailed, ...args) {\n        if (xml.getElementsByTagName('SUCCESS').length > 0) {\n            callbackSuccess(xml, ...args);\n        } else {\n            callbackFailed(xml, ...args);\n        }\n    }\n\n    static _checkTransacktionFailed (xml, callbackSuccess, callbackFailed, ...args) {\n        callbackFailed(xml, ...args);\n    }\n\n    static doQuery(klasse, filter, callbackSuccess, callbackFailed, ...args) {\n        var xml = '<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>' +\n            '<wfs:GetFeature xmlns=\"http://xml.novasib.de\" ' +\n            'xmlns:wfs=\"http://www.opengis.net/wfs\" ' +\n            'xmlns:gml=\"http://www.opengis.net/gml\" ' +\n            'xmlns:ogc=\"http://www.opengis.net/ogc\" ' +\n            'xmlns:xlink=\"http://www.w3.org/1999/xlink\" ' +\n            'xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" service=\"WFS\" version=\"1.0.0\" ' +\n            'xsi:schemaLocation=\"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd\">' +\n            '<wfs:Query typeName=\"' + klasse + '\">' +\n            filter +\n            '</wfs:Query>' +\n            '</wfs:GetFeature>';\n        return PublicWFS.doSoapRequest(xml, callbackSuccess, callbackFailed, ...args)\n    }\n\n    static doQueryWait(klasse, filter) {\n        var xml = '<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>' +\n            '<wfs:GetFeature xmlns=\"http://xml.novasib.de\" ' +\n            'xmlns:wfs=\"http://www.opengis.net/wfs\" ' +\n            'xmlns:gml=\"http://www.opengis.net/gml\" ' +\n            'xmlns:ogc=\"http://www.opengis.net/ogc\" ' +\n            'xmlns:xlink=\"http://www.w3.org/1999/xlink\" ' +\n            'xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" service=\"WFS\" version=\"1.0.0\" ' +\n            'xsi:schemaLocation=\"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd\">' +\n            '<wfs:Query typeName=\"' + klasse + '\">' +\n            filter +\n            '</wfs:Query>' +\n            '</wfs:GetFeature>';\n\n        var xmlhttp = new XMLHttpRequest();\n        xmlhttp.open('POST', CONFIG.PUBLIC_WFS_URL, true);\n        xmlhttp.setRequestHeader('Content-Type', 'text/xml');\n        xmlhttp.send(xml);\n\n        while(xmlhttp.readyState != 4) {};\n        if (xmlhttp.status == 200) {\n            return xmlhttp.responseXML;\n        } \n        return null;\n    }\n    \n    static showMessage(text, error) {\n        let m = document.createElement('div');\n        m.className = 'nachricht';\n        m.innerHTML = text;\n        document.body.append(m);\n\n        let ausblenden = function () {\n            m.style.display = 'none';\n            m.remove();\n        }\n\n        if (error) {\n            m.style.backgroundColor = 'rgba(255,100,100,0.8)';\n            window.setTimeout(ausblenden, 3000);\n        } else {\n            m.style.backgroundColor = 'rgba(100, 200,100,0.8)';\n            window.setTimeout(ausblenden, 5000);\n        }\n        m.style.display = 'block';\n    }\n}\n\nmodule.exports = PublicWFS;","import '../css/index.css';\nimport PublicWFS from './PublicWFS.js';\n\n//?Service=WFS&Request=GetFeature&TypeName=Projekt&Filter=<Filter><PropertyIsEqualTo><PropertyName>status</PropertyName><Literal>1</Literal></PropertyIsEqualTo></Filter>\n\nfunction loadER() {\n\tconsole.log((new PublicWFS()).doQuery);\n    PublicWFS.doQuery('Projekt',\n        '<Filter><And>' +\n        '<PropertyIsEqualTo><PropertyName>status</PropertyName>' +\n        '<Literal>1</Literal>' +\n        '</PropertyIsEqualTo><PropertyIsEqualTo>' +\n        '<PropertyName>typ</PropertyName>' +\n        '<Literal>D</Literal>' +\n        '</PropertyIsEqualTo>' +\n        '</And></Filter>', readER,\n        function () { PublicWFS.showMessage(\"Konnte ERs nicht laden\") });\n}\n\nwindow.addEventListener('load', loadER());\n\nvar er = {}\nvar select = document.getElementById(\"er_select\")\n\nfunction readER(xmlhttp) {\n    var proj = xmlhttp.responseXML.getElementsByTagName(\"Projekt\")\n    select.innerHTML = \"\"\n\n    for (var i = 0; i < proj.length; i++) {\n\n        projekt = proj[i].getAttribute(\"fid\")\n\n        er[projekt] = {}\n\n        er[projekt]['nr'] = proj[i].getElementsByTagName(\"projekt\")[0].firstChild.data\n        var kurzbez = proj[i].getElementsByTagName(\"kurzbez\")\n        if (kurzbez.length > 0)\n            er[projekt]['kurzbez'] = proj[i].getElementsByTagName(\"kurzbez\")[0].firstChild.data\n        else\n            er[projekt]['kurzbez'] = \"\"\n        var langbez = proj[i].getElementsByTagName(\"langbez\")\n        if (langbez.length > 0)\n            er[projekt]['langbez'] = proj[i].getElementsByTagName(\"langbez\")[0].firstChild.data\n        else\n            er[projekt]['langbez'] = \"\"\n        er[projekt]['ownerName'] = proj[i].getElementsByTagName(\"ownerName\")[0].firstChild.data\n        er[projekt]['anlagedat'] = proj[i].getElementsByTagName(\"anlagedat\")[0].firstChild.data\n    }\n\n\n    for (var pid in er) {\n        var o = document.createElement('option')\n        var v = document.createAttribute(\"value\")\n        v.value = pid\n        o.setAttributeNode(v);\n        var t = document.createTextNode(er[pid]['nr'].substr(11) + \" - \" + er[pid]['kurzbez']);\n        o.appendChild(t)\n        select.appendChild(o)\n    }\n    //document.getElementById(\"platzhalter\").remove();\n    select.disabled = false\n    aenderung()\n}\n\nfunction aenderung() {\n    var p = er[select.value]\n    document.getElementById(\"nummer\").innerHTML = p['nr']\n    document.getElementById(\"kurzbez\").innerHTML = p['kurzbez']\n    document.getElementById(\"langbez\").innerHTML = p['langbez']\n    document.getElementById(\"bearbeiter\").innerHTML = p['ownerName']\n    document.getElementById(\"datum\").innerHTML = p['anlagedat']\n}"]}